<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <!--[if IE]>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <![endif]-->
	<title>centos配置iptables</title>
    <meta name="description" content="centos配置iptables" />
    <meta name="keywords" content="linux nginx apache mysql php 技术博客" />
    <!-- BOOTSTRAP CORE STYLE CSS -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet" />
     <!-- FONTAWESOME STYLE CSS -->
     <link href="/assets/css/font-awesome.css" rel="stylesheet" />
    <!-- CUSTOM STYLE CSS -->
    <link href="/assets/css/style.css" rel="stylesheet" />
</head>
<body >
    <section class="header-section">
        <div class="container">
            <div class="row">
                <div class="col-md-2">
                    <img src="/assets/img/person.jpg" class="img-circle img-responsive" />
                </div>
                <div class="col-md-5 text-center">
                    <h1><strong>Jhon Alexan </strong></h1>
                    <h4>Blogger & Designer</h4>
                </div>
                <div class="col-md-5">
                    <h3>WHO M I :</h3>

                    I am a 26 years old guy who loves bloggging and designing .
                      I will provide all my works for free here with some good piece of information.
                     You can reach me at <i><strong>info@mydomain.com</strong></i>
                </div>
            </div>
        </div>
    </section>
    <!--HOME SECTION END-->

    <section>
        <div class="container">
            <div class="row">
                <div class="col-md-2 spon-txt">
                    <span>My Sponsers: </span>
                </div>
                <div class="col-md-10">
                    <img src="/assets/img/clients.png" alt="" class="img-rounded img-responsive" />
                </div>

            </div>
        </div>
    </section>
    <!--SPONSORS SECTION END-->
    <hr />
     <section  >
        <div class="container">
            <div class="row">
                <div class="col-md-9" >

                    <h2 id="iptables">检查iptables服务的状态</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>service iptables status
如果出现 iptables: Firewall is not running ,说明没有启动或没有规则
</code></pre></div>
<h2 id="iptables">启动iptables服务</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>service iptables start
第一次配置前消除默认的规则

这个一定要先做，不然清空后可能会悲剧
iptables -P INPUT ACCEPT

以下的可选
清空默认所有规则 
iptables -F

清空自定义的所有规则 
iptables -X

计数器置0
iptables -Z
</code></pre></div>
<h2 id=">配置规则</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>如果没有此规则，你将不能通过127.0.0.1访问本地服务，例如ping 127.0.0.1 
iptables -A INPUT -i lo -j ACCEPT    

开启ssh端口22 
iptables -A INPUT -p tcp --dport 22 -j ACCEPT

开启FTP端口21 
iptables -A INPUT -p tcp --dport 21 -j ACCEPT

开启web服务端口80
iptables -A INPUT -p tcp --dport 80 -j ACCEPT

tomcat 
iptables -A INPUT -p tcp --dport 8080 -j ACCEPT

mysql 
iptables -A INPUT -p tcp --dport xxxx -j ACCEPT

允许icmp包通过,也就是允许ping 
iptables -A INPUT -p icmp -m icmp --icmp-type 8 -j ACCEPT

允许所有对外请求的返回包 
本机对外请求相当于OUTPUT,对于返回数据包必须接收啊，这相当于INPUT了 
iptables -A INPUT -m state --state ESTABLISHED -j ACCEPT

如果要添加内网ip信任（接受其所有TCP请求） 
iptables -A INPUT -p tcp -s 45.96.174.68 -j ACCEPT

每秒中最多允许5个新连接
iptables -A FORWARD -p tcp --syn -m limit --limit 1/s --limit-burst 5 -j ACCEPT

每秒中最多允许5个新连接
iptables -A FORWARD -p tcp --tcp-flags SYN,ACK,FIN,RST RST -m limit --limit 1/s -j ACCEPT

Ping洪水攻击
iptables -A FORWARD -p icmp --icmp-type echo-request -m limit --limit 1/s -j ACCEPT

封单个IP的命令是：
iptables -I INPUT -s 222.34.135.106 -j DROP

封IP段的命令是：
iptables -I INPUT -s 211.1.0.0/16 -j DROP
iptables -I INPUT -s 211.2.0.0/16 -j DROP
iptables -I INPUT -s 211.3.0.0/16 -j DROP

封整个段的命令是：
iptables -I INPUT -s 211.0.0.0/8 -j DROP

封几个段的命令是：
iptables -I INPUT -s 61.37.80.0/24 -j DROP
iptables -I INPUT -s 61.37.81.0/24 -j DROP

过滤所有非以上规则的请求 
iptables -P INPUT DROP
</code></pre></div>
<h2 id=">保存重启</h2>
<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>service iptables save
service iptables restart
</code></pre></div>

                     <!--COMMENTS SECTION END-->
                </div>
        <div class="col-md-3">
    <ul class="list-group">
        <li class="list-group-item">
   <strong>Main Categories</strong>
  </li>
  <li class="list-group-item">
    <span class="badge">104</span>
    Technology 
  </li>
        <li class="list-group-item">
    <span class="badge">34</span>
    Blogging 
  </li>
        <li class="list-group-item">
    <span class="badge">10</span>
    Information 
  </li>
         <li class="list-group-item">
    <span class="badge">50</span>
    Security 
  </li>
         <li class="list-group-item">
   <strong>Other Categories</strong>
  </li>
  <li class="list-group-item">
    <span class="badge">104</span>
    Technology 
  </li>
        <li class="list-group-item">
    <span class="badge">34</span>
    Blogging 
  </li>
        <li class="list-group-item">
    <span class="badge">10</span>
    Information 
  </li>
         <li class="list-group-item">
    <span class="badge">50</span>
    Security 
  </li>
</ul>
                </div>
            </div>
</div>
    </section>
    <hr />
     <div class="container">
            <div class="row">
                <div class="col-md-12 text-center" style="padding:20px 5px;" >
                    <div id="copyright">
                        &copy 2017 Jhon Alexan | <a href="https://dongzhidong.github.io/" title="linux nginx apache mysql php 技术　博客">网站链接</a>
                    </div>
                    </div>
                </div>
                </div>
</body>
</html>
